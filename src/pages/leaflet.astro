---
import Layout from "../layouts/Layout.astro";
import "leaflet/dist/leaflet.css";
---

<Layout title="TP7 — Carte Leaflet">
  <h1 class="text-2xl mb-4">Leaflet — établissements</h1>
  <div id="map" style="height:600px; border-radius:.75rem; overflow:hidden"></div>

  <script type="module">
    import L from "leaflet";
    import etablissements from "../assets/listeEtablissements.json";

    const map = L.map("map").setView([46.6033, 1.888], 6);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: "© OpenStreetMap",
    }).addTo(map);

    etablissements.forEach((d) => {
      const lat = d.lat ?? d.latitude;
      const lon = d.lon ?? d.longitude;
      if (lat != null && lon != null) {
        L.marker([+lat, +lon])
          .addTo(map)
          .bindPopup(d.name ?? d.nom ?? "Établissement");
      }
    });
  </script>
</Layout>
